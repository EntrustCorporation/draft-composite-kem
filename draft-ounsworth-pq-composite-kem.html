<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Composite KEM For Use In Internet PKI</title>
<meta content="Mike Ounsworth" name="author">
<meta content="John Gray" name="author">
<meta content='
       The migration to post-quantum cryptography is unique in the history of modern digital cryptography in that neither the old outgoing nor the new incoming algorithms are fully trusted to protect data for the required data lifetimes. The outgoing algorithms, such as RSA and elliptic curve, may fall to quantum cryptalanysis, while the incoming post-quantum algorithms face uncertainty about both the underlying mathematics as well as hardware and software implementations that have not had sufficient maturing time to rule out classical cryptanalytic attacks and implementation bugs. 
       Cautious implementers may wish to layer cryptographic algorithms such that an attacker would need to break all of them in order to compromise the data being protected using either a Post-Quantum / Traditional Hybrid, Post-Quantum / Post-Quantum Hybrid, or combinations thereof. This document, and its companions, defines a specific instantiation of hybrid paradigm called "composite" where multiple cryptographic algorithms are combined to form a single key, signature, or key encapsulation mechanism (KEM) such that they can be treated as a single atomic object at the protocol level. 
       This document defines the structure CompositeCiphertextValue which is a sequence of the respective ciphertexts for each component algorithm. Explicit pairings of algorithms are defined which should meet most Internet needs. The generic composite key type is also defined which allows arbitrary combinations of key types to be placed in the CompositePublicKey and CompositePrivateKey structures without needing the combination to be pre-registered or pre-agreed. For the purpose of combining KEMs, the combiner function from   is used. 
       This document is intended to be coupled with the composite keys
structure define in   and the CMS KEM-TRANS mechanism in  . 
       



    ' name="description">
<meta content="xml2rfc 3.12.2" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ounsworth-pq-composite-kem-01" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.2
    Python 3.10.6
    weasyprint 54.1
-->
<link href="draft-ounsworth-pq-composite-kem.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">PQ Composite Keys</td>
<td class="right">January 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Ounsworth &amp; Gray</td>
<td class="center">Expires 29 July 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">LAMPS</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ounsworth-pq-composite-kem-01</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-01-25" class="published">25 January 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-07-29">29 July 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Ounsworth</div>
<div class="org">Entrust</div>
</div>
<div class="author">
      <div class="author-name">J. Gray</div>
<div class="org">Entrust</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Composite KEM For Use In Internet PKI</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The migration to post-quantum cryptography is unique in the history of modern digital cryptography in that neither the old outgoing nor the new incoming algorithms are fully trusted to protect data for the required data lifetimes. The outgoing algorithms, such as RSA and elliptic curve, may fall to quantum cryptalanysis, while the incoming post-quantum algorithms face uncertainty about both the underlying mathematics as well as hardware and software implementations that have not had sufficient maturing time to rule out classical cryptanalytic attacks and implementation bugs.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">Cautious implementers may wish to layer cryptographic algorithms such that an attacker would need to break all of them in order to compromise the data being protected using either a Post-Quantum / Traditional Hybrid, Post-Quantum / Post-Quantum Hybrid, or combinations thereof. This document, and its companions, defines a specific instantiation of hybrid paradigm called "composite" where multiple cryptographic algorithms are combined to form a single key, signature, or key encapsulation mechanism (KEM) such that they can be treated as a single atomic object at the protocol level.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This document defines the structure CompositeCiphertextValue which is a sequence of the respective ciphertexts for each component algorithm. Explicit pairings of algorithms are defined which should meet most Internet needs. The generic composite key type is also defined which allows arbitrary combinations of key types to be placed in the CompositePublicKey and CompositePrivateKey structures without needing the combination to be pre-registered or pre-agreed. For the purpose of combining KEMs, the combiner function from <span>[<a href="#I-D.ounsworth-cfrg-kem-combiners" class="xref">I-D.ounsworth-cfrg-kem-combiners</a>]</span> is used.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
<p id="section-abstract-4">This document is intended to be coupled with the composite keys
structure define in <span>[<a href="#I-D.ounsworth-pq-composite-keys" class="xref">I-D.ounsworth-pq-composite-keys</a>]</span> and the CMS KEM-TRANS mechanism in <span>[<a href="#I-D.perret-prat-lamps-cms-pq-kem" class="xref">I-D.perret-prat-lamps-cms-pq-kem</a>]</span>.<a href="#section-abstract-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-2">
<a href="#name-status-of-this-memo-2" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 29 July 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-2">
<a href="#name-copyright-notice-2" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-2">
<a href="#name-table-of-contents-2" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-changes-in-version-01-2" class="xref">Changes in version -01</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-introduction-2" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-terminology-2" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-composite-kem-structures-2" class="xref">Composite KEM Structures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-key-encapsulation-mechanisms" class="xref">Key Encapsulation Mechanisms (KEMs)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-specifying-composite-kem-alg" class="xref">Specifying Composite KEM Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-composite-keys-2" class="xref">Composite Keys</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-key-usage-bits-2" class="xref">Key Usage Bits</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-compositeciphertextvalue-2" class="xref">CompositeCiphertextValue</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-encoding-rules-2" class="xref">Encoding Rules</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-kem-combiner-2" class="xref">KEM Combiner</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-algorithm-identifiers-2" class="xref">Algorithm Identifiers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-id-kyber512-ecdh-p256-shake1" class="xref">id-Kyber512-ECDH-P256-SHAKE128</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-id-kyber512-ecdh-brainpoolp2" class="xref">id-Kyber512-ECDH-brainpoolP256r1-shake128</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-id-kyber512-x25519-shake128-2" class="xref">id-Kyber512-X25519-shake128</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-id-kyber768-rsa-shake256-2" class="xref">id-Kyber768-RSA-shake256</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-id-kyber768-ecdh-p256-shake2" class="xref">id-Kyber768-ECDH-P256-shake256</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-id-kyber768-ecdh-brainpoolp2" class="xref">id-Kyber768-ECDH-brainpoolP256r1-shake256</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="xref">4.7</a>.  <a href="#name-id-kyber768-x25519-shake256-2" class="xref">id-Kyber768-X25519-shake256</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="xref">4.8</a>.  <a href="#name-id-kyber1024-ecdh-p384-shake" class="xref">id-Kyber1024-ECDH-P384-shake256</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="xref">4.9</a>.  <a href="#name-id-kyber1024-ecdh-brainpoolp" class="xref">id-Kyber1024-ECDH-brainpoolP384r1-shake256</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.10">
                <p id="section-toc.1-1.4.2.10.1"><a href="#section-4.10" class="xref">4.10</a>. <a href="#name-id-kyber1024-x448-shake256-2" class="xref">id-Kyber1024-X448-shake256</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.11">
                <p id="section-toc.1-1.4.2.11.1"><a href="#section-4.11" class="xref">4.11</a>. <a href="#name-id-alg-composite-kem-shake12" class="xref">id-alg-composite-kem-shake128</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.12">
                <p id="section-toc.1-1.4.2.12.1"><a href="#section-4.12" class="xref">4.12</a>. <a href="#name-id-alg-composite-kem-shake25" class="xref">id-alg-composite-kem-shake256</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-in-practice-2" class="xref">In Practice</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-backwards-compatibility-2" class="xref">Backwards Compatibility</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-k-of-n-modes-2" class="xref">K-of-N modes</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-parallel-pkis-2" class="xref">Parallel PKIs</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iana-considerations-2" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations-2" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-policy-for-deprecated-and-ac" class="xref">Policy for Deprecated and Acceptable Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-or-modes-2" class="xref">OR Modes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-cryptographic-review-of-comb" class="xref">Cryptographic review of combiner</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="xref">7.3.1</a>.  <a href="#name-need-for-a-kdf-within-the-co" class="xref">Need for a KDF within the combiner</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="xref">7.3.2</a>.  <a href="#name-apop-attack-on-concatenated-" class="xref">APOP Attack on concatenated keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.3">
                    <p id="section-toc.1-1.7.2.3.2.3.1"><a href="#section-7.3.3" class="xref">7.3.3</a>.  <a href="#name-aviram2022-2" class="xref">Aviram2022</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references-2" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references-2" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references-2" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-examples-2" class="xref">Examples</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-asn1-module-2" class="xref">ASN.1 Module</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-intellectual-property-consid" class="xref">Intellectual Property Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-D" class="xref">Appendix D</a>.  <a href="#name-contributors-and-acknowledge" class="xref">Contributors and Acknowledgements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-D.1" class="xref">D.1</a>.  <a href="#name-making-contributions-2" class="xref">Making contributions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-E" class="xref"></a><a href="#name-authors-addresses-2" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="changes-in-version-01">
<section id="section-1">
      <h2 id="name-changes-in-version-01-2">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-changes-in-version-01-2" class="section-name selfRef">Changes in version -01</a>
      </h2>
<ul class="normal">
<li class="normal" id="section-1-1.1">Sycronized terminology with I-D.draft-driscoll-pqt-hybrid-terminology-01.<a href="#section-1-1.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="sec-intro">
<section id="section-2">
      <h2 id="name-introduction-2">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-introduction-2" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-2-1">During the transition to post-quantum cryptography, there will be uncertainty as to the strength of cryptographic algorithms; we will no longer fully trust traditional cryptography such as RSA, Diffie-Hellman, DSA and their elliptic curve variants, while we may also not fully trust their post-quantum replacements until they have had sufficient scrutiny and time to discover and fix implementation bugs. Unlike previous cryptographic algorithm migrations, the choice of when to migrate and which algorithms to migrate to, is not so clear. Even after the migration period, it may be advantageous for an entity's cryptographic identity to be composed of multiple public-key algorithms.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The deployment of composite public keys and composite encryption using post-quantum algorithms will face two challenges<a href="#section-2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-3.1">Algorithm strength uncertainty: During the transition period, some post-quantum signature and encryption algorithms will not be fully trusted, while also the trust in legacy public key algorithms will start to erode.  A relying party may learn some time after deployment that a public key algorithm has become untrustworthy, but in the interim, they may not know which algorithm an adversary has compromised.<a href="#section-2-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.2">Migration: During the transition period, systems will require mechanisms that allow for staged migrations from fully classical to fully post-quantum-aware cryptography.<a href="#section-2-3.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-4">This document provides a mechanism to address algorithm strength uncertainty by building on <span>[<a href="#I-D.ounsworth-pq-composite-keys" class="xref">I-D.ounsworth-pq-composite-keys</a>]</span> by providing the format and process for combining multiple cryptographic algorithms into a single key encapsulation operation. Backwards compatibility is not directly covered in this document, but is the subject of <a href="#sec-backwards-compat" class="xref">Section 5.1</a>.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">This document is intended for general applicability anywhere that key establishment or enveloped content encryption is used within PKIX or CMS structures.<a href="#section-2-5" class="pilcrow">¶</a></p>
<div id="sec-terminology">
<section id="section-2.1">
        <h3 id="name-terminology-2">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-terminology-2" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-2.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>  <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">This document is consistent with all terminology from <span>[<a href="#I-D.driscoll-pqt-hybrid-terminology" class="xref">I-D.driscoll-pqt-hybrid-terminology</a>]</span>.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">In addition, the following terms are used in this document:<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">BER:
          Basic Encoding Rules (BER) as defined in <span>[<a href="#X.690" class="xref">X.690</a>]</span>.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">CLIENT:
          Any software that is making use of a cryptographic key.
          This includes a signer, verifier, encrypter, decrypter.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">COMBINER:
          A combiner specifies how multiple shared secrets
          are combined into a single shared secret.
DER:
          Distinguished Encoding Rules as defined in <span>[<a href="#X.690" class="xref">X.690</a>]</span>.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.1-7">KEM:
        A key encapsulation mechanism as defined in <a href="#sec-kems" class="xref">Section 3.1</a>.<a href="#section-2.1-7" class="pilcrow">¶</a></p>
<p id="section-2.1-8">PKI:
          Public Key Infrastructure, as defined in <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>.<a href="#section-2.1-8" class="pilcrow">¶</a></p>
<p id="section-2.1-9">SHARED SECRET:
        A value established between two communicating parties for use as cryptographic key material, but which cannot be learned by an active or 
        passive adversary. This document is concerned with shared secrets established via public key cryptagraphic operations.<a href="#section-2.1-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="composite-kem-structures">
<section id="section-3">
      <h2 id="name-composite-kem-structures-2">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-composite-kem-structures-2" class="section-name selfRef">Composite KEM Structures</a>
      </h2>
<div id="sec-kems">
<section id="section-3.1">
        <h3 id="name-key-encapsulation-mechanisms">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-key-encapsulation-mechanisms" class="section-name selfRef">Key Encapsulation Mechanisms (KEMs)</a>
        </h3>
<p id="section-3.1-1">We borrow here the definition of a key encapsulation mechanism (KEM) from <span>[<a href="#I-D.ietf-tls-hybrid-design" class="xref">I-D.ietf-tls-hybrid-design</a>]</span>, in which a KEM is a cryptographic primitive that consists of three algorithms:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">KeyGen() -&gt; (pk, sk): A probabilistic key generation algorithm,
which generates a public key pk and a secret key sk.<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.2">Encaps(pk) -&gt; (ct, ss): A probabilistic encapsulation algorithm,
which takes as input a public key pk and outputs a ciphertext ct
and shared secret ss.<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.3">Decaps(sk, ct) -&gt; ss: A decapsulation algorithm, which takes as
input a secret key sk and ciphertext ct and outputs a shared
secret ss, or in some cases a distinguished error value.<a href="#section-3.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-3">This document is not concerned with the KeyGen() algorithm of a KEM, but it is included above for completeness.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">The KEM interface defined above differs from both traditional key transport mechanism (for example for use with KeyTransRecipientInfo defined in <span>[<a href="#RFC5652" class="xref">RFC5652</a>]</span>), and key agreement (for example for use with KeyAgreeRecipientInfo defined in <span>[<a href="#RFC5652" class="xref">RFC5652</a>]</span>).<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">The KEM interface was chosen as the interface for a composite key exchange because it allows for arbitrary combinations of component algorithm types since both key transport and key agreement mechanisms can be promoted into KEMs in the following ways:<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">A key transport mechanism can be transformed into a KEM.Encaps(pk) by generating a random shared secret ss and performing KeyTrans.Encrypt(pk, ss) -&gt; ct; and into a KEM.Decaps(sk, ct) by KeyTrans.Decrypt(sk, ct) -&gt; ss. This follows the pattern of RSA-KEM <span>[<a href="#RFC5990" class="xref">RFC5990</a>]</span>.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7">A key agreement mechanism can be transformed into a KEM.Encaps(pk) by generating an ephemeral key pair (pk_e, sk_e), and performing KeyAgree(pk, sk_e) -&gt; (ss, pk_e); and into a KEM.Decaps(sk, ct) by completing the key agreement as KeyAgree(pk_e, sk) -&gt; ss.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1-8">A composite KEM allows two or more underlying key transport, key agreement, or KEM algorithms to be combined into a single cryptographic operations by performing each operation, transformed to a KEM as outline above, and using a specified combiner function to combine the two or more component shared secrets into a single shared secret.<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.1-9">The main security property for KEMs is indistinguishability under
adaptive chosen ciphertext attack (IND-CCA2), which means that shared
secret values should be indistinguishable from random strings even
given the ability to have other arbitrary ciphertexts decapsulated.<a href="#section-3.1-9" class="pilcrow">¶</a></p>
<p id="section-3.1-10">EDNOTE: it would be really nice for security proofs if definition of KEM included that the bits of the shared secret output need to be uniformly distributed (ie IND-CCA), because for example it would then be safe to XOR or truncate them. While the NIST PQC candidates all seem to do this, we could not find a definition of "KEM" that includes it as a requirement.<a href="#section-3.1-10" class="pilcrow">¶</a></p>
<p id="section-3.1-11">A weaker security notion is indistinguishability under chosen
plaintext attack (IND-CPA), which means that the shared secret values
should be indistinguishable from random strings given a copy of the
public key.  IND-CPA roughly corresponds to security against a
passive attacker, and sometimes corresponds to one-time key exchange.<a href="#section-3.1-11" class="pilcrow">¶</a></p>
<p id="section-3.1-12">The composite KEM mechanisms meets these security properties if and only if the component primitives meet them.<a href="#section-3.1-12" class="pilcrow">¶</a></p>
<p id="section-3.1-13">TODO: needs more formal analysis that the methods of transforming KeyTrans and KeyAgree meet this.<a href="#section-3.1-13" class="pilcrow">¶</a></p>
<p id="section-3.1-14">EDNOTE:  Discussed use of ASN.1 to combine the shared secrets. ASN.1 is nice because it embeds the length values for
us. Decided instead to run each component shared secret through the supplied KDF which will normalize all the lengths.<a href="#section-3.1-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="specifying-composite-kem-algorithms">
<section id="section-3.2">
        <h3 id="name-specifying-composite-kem-alg">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-specifying-composite-kem-alg" class="section-name selfRef">Specifying Composite KEM Algorithms</a>
        </h3>
<p id="section-3.2-1">The following is the mandatory to specify information when specifying a composite KEM type:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">An AlgorithmIdentifier OID for the composite KEM type.<a href="#section-3.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-2.2">Component algorithms that will correspond to each position within the <code>CompositeCiphertextValue</code>. (see <a href="#sec-CompositeCiphertextValue" class="xref">Section 3.4</a>).<a href="#section-3.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-2.3">A KEM combiner appropriate to the specific choice of component algorithms (see <a href="#sec-kem-combiner" class="xref">Section 3.6</a>).<a href="#section-3.2-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-3">TODO - LAMPS needs to define a KEM-ALGORITHM  -  extension to RFC 5912 - Bring to IETF. We just made up the prefix "kema" (for "KEM algorithm") is that the right prefix?<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-4">
<pre>
kema-CompositeKEM KEM-ALGORITHM ::= {
    IDENTIFIER id-alg-composite-kem
    VALUE CompositeCiphertextValue
    PARAMS composite-kem-params
    PUBLIC-KEYS { pk-Composite }
    SMIME-CAPS { IDENTIFIED BY id-alg-composite } }
}
</pre><a href="#section-3.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="composite-keys">
<section id="section-3.3">
        <h3 id="name-composite-keys-2">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-composite-keys-2" class="section-name selfRef">Composite Keys</a>
        </h3>
<p id="section-3.3-1">A composite key is a single key object that performs an atomic cryptographic operation as
defined in <span>[<a href="#I-D.ounsworth-pq-composite-keys" class="xref">I-D.ounsworth-pq-composite-keys</a>]</span>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<div id="key-usage-bits">
<section id="section-3.3.1">
          <h4 id="name-key-usage-bits-2">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-key-usage-bits-2" class="section-name selfRef">Key Usage Bits</a>
          </h4>
<p id="section-3.3.1-1">When using composite KEM keys in a structure which defines a key usage (such as in an 
X509Certificate as defined in <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>), the following key usage MUST be used.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3.1-2">
<pre>
  keyEncipherment
</pre><a href="#section-3.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.3.1-3">Additional key usages SHOULD not be used.<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-4">EDNOTE:  The main argument for using keyEncipherment verses keyAgreement is that multiple 
parties are required to contribute to a key agreement verses a single party in keyEncipherment.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.3.1-5">EDNOTE:  It is recognized that KEMS will be added into other PKIX and X509 standards and LAMPS needs to make sure they all make the same choice about the key usage of a KEM key.<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-CompositeCiphertextValue">
<section id="section-3.4">
        <h3 id="name-compositeciphertextvalue-2">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-compositeciphertextvalue-2" class="section-name selfRef">CompositeCiphertextValue</a>
        </h3>
<p id="section-3.4-1">The compositeCipherTextValue is a concatenation of the ciphertexts of the
underlying component algorithms.  It is represented in ASN.1 as follows:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4-2">
<pre>
CompositeCiphertextValue ::= SEQUENCE SIZE (2..MAX) OF BIT STRING
</pre><a href="#section-3.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="encoding-rules">
<section id="section-3.5">
        <h3 id="name-encoding-rules-2">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-encoding-rules-2" class="section-name selfRef">Encoding Rules</a>
        </h3>
<p id="section-3.5-1">Many protocol specifications will require that composite KEM data structures be represented by an octet string or bit string.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">When an octet string is required, the DER encoding of the composite data structure SHALL be used directly.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">EDNOTE: will this definition include an ASN.1 tag and length byte inside the OCTET STRING object? If so, that's probably an extra unnecessary layer.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.5-4">When a bit string is required, the octets of the DER encoded composite data structure SHALL be used as the bits of the bit string, with the most significant bit of the first octet becoming the first bit, and so on, ending with the least significant bit of the last octet becoming the last bit of the bit string.<a href="#section-3.5-4" class="pilcrow">¶</a></p>
<p id="section-3.5-5">In the interests of simplicity and avoiding compatibility issues, implementations that parse these structures MAY accept both BER and DER.<a href="#section-3.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-kem-combiner">
<section id="section-3.6">
        <h3 id="name-kem-combiner-2">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-kem-combiner-2" class="section-name selfRef">KEM Combiner</a>
        </h3>
<p id="section-3.6-1">This document follows the advice of <span>[<a href="#I-D.ounsworth-cfrg-kem-combiners" class="xref">I-D.ounsworth-cfrg-kem-combiners</a>]</span>: the outputs of multiple KEMs are combined as<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.6-2">TODO: Aron Wussler has a better version of the KEM combiner that should probably be rolled into <span>[<a href="#I-D.ounsworth-cfrg-kem-combiners" class="xref">I-D.ounsworth-cfrg-kem-combiners</a>]</span> and then included here: <code>KMAC256(domainSeparation, 0x00000001 || K1 || K2 || fixedInfo, outputBits, "KDF")</code>. TODO: update that doc, then take the new version here.<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<p id="section-3.6-3">EDNOTE: should we add in a context string? Ex.: <code>KDF( "id-kem-Kyber512-ECDH-P256-SHAKE128" || H(ss1) || H(ss2) )</code>  ?<a href="#section-3.6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.6-4">
<pre>
KDF( H(ss1) || H(ss2) )
</pre><a href="#section-3.6-4" class="pilcrow">¶</a>
</div>
<p id="section-3.6-5">where <code>||</code> represents concatenation.<a href="#section-3.6-5" class="pilcrow">¶</a></p>
<p id="section-3.6-6">Note that explicitly-defined algorithm combinations MAY opt to define the combiner without the inner hash on <code>H(ss1)</code> and <code>H(ss2)</code> the component KEMs use a KDF internally when producing its output.<a href="#section-3.6-6" class="pilcrow">¶</a></p>
<p id="section-3.6-7">Each registered composite KEM algorithm must specify the exact KEM combiner construction that is to be used.<a href="#section-3.6-7" class="pilcrow">¶</a></p>
<p id="section-3.6-8">Below we make the following pairings of kyber security level and KDF:<a href="#section-3.6-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-9.1">Kyber512: shake128/256<a href="#section-3.6-9.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.6-9.2">Kyber768: shake256/384<a href="#section-3.6-9.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.6-9.3">Kyber1024 shake256/512<a href="#section-3.6-9.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-alg-ids">
<section id="section-4">
      <h2 id="name-algorithm-identifiers-2">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-algorithm-identifiers-2" class="section-name selfRef">Algorithm Identifiers</a>
      </h2>
<p id="section-4-1">This section defines algorithm identifiers, component algorithms and their ordering for composite combinations. The combinations registered in this section are intended to strike a balance between the overall number of combinations ("the combinatorial explosion problem"), while also covering the needs of a wide range of protocols, applications, and regulatory environments in which X.509-based technologies are used.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">This section is not intended to be exhaustive and other authors may define OIDs for new combinations so long as they are compatible with the structures and processes defined in this and the companion signature and encryption documents.<a href="#section-4-2" class="pilcrow">¶</a></p>
<span id="name-composite-kem-key-types-2"></span><div id="tab-kem-agls">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-composite-kem-key-types-2" class="selfRef">Composite KEM key types</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">KEM type</th>
            <th class="text-left" rowspan="1" colspan="1">Definition</th>
            <th class="text-left" rowspan="1" colspan="1">OID</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-Kyber512-ECDH-P256-shake128</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-id-Kyber512-ECDH-P256-SHAKE128" class="xref">Section 4.1</a>
</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-Kyber512-ECDH-brainpoolP256r1-shake128</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-id-Kyber512-ECDH-brainpoolP256r1-shake128" class="xref">Section 4.2</a>
</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-Kyber512-X25519-shake128</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-id-Kyber512-X25519-shake128" class="xref">Section 4.3</a>
</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-Kyber768-RSA-shake256</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-id-Kyber768-RSA-shake256" class="xref">Section 4.4</a>
</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-Kyber768-ECDH-P256-shake256</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-id-Kyber768-ECDH-P256-shake256" class="xref">Section 4.5</a>
</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-Kyber768-ECDH-brainpoolP256r1-shake256</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-id-Kyber768-ECDH-brainpoolP256r1-shake256" class="xref">Section 4.6</a>
</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-Kyber768-X25519-shake256</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-id-Kyber768-X25519-shake256" class="xref">Section 4.7</a>
</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-Kyber1024-ECDH-P384-shake256</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-id-Kyber1024-ECDH-P384-shake256" class="xref">Section 4.8</a>
</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-Kyber1024-ECDH-brainpoolP384r1-shake256</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-id-Kyber1024-ECDH-brainpoolP384r1-shake256" class="xref">Section 4.9</a>
</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-Kyber1024-X448-shake256</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-id-Kyber1024-X448-shake256" class="xref">Section 4.10</a>
</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-composite-key-shake128</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-generic-composite-kem-shake128" class="xref">Section 4.11</a>
</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-composite-key-shake256</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-generic-composite-kem-shake256" class="xref">Section 4.12</a>
</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-4-4">These combinations were chosen according to the following rough guidelines:<a href="#section-4-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4-5">
<li id="section-4-5.1">One RSA combination is provided (but RSA modulus size not mandated), matched with NIST PQC Level 3 algorithms.<a href="#section-4-5.1" class="pilcrow">¶</a>
</li>
        <li id="section-4-5.2">NIST <span>[<a href="#RFC6090" class="xref">RFC6090</a>]</span>, Edwards <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>, and Brainpool <span>[<a href="#RFC5639" class="xref">RFC5639</a>]</span> elliptic curve algorithms are provided. NIST PQC Levels 1 - 3 algorithms are matched with 256-bit curves, while NIST levels 4 - 5 are matched with 384-bit elliptic curves. This provides a balance between matching classical security levels of post-quantum and traditional algorithms, and also selecting elliptic curves which already have wide adoption.<a href="#section-4-5.2" class="pilcrow">¶</a>
</li>
        <li id="section-4-5.3">NIST level 1 candidates (Kyber512) are provided, matched with 256-bit elliptic curves, intended for constrained use cases.<a href="#section-4-5.3" class="pilcrow">¶</a>
</li>
        <li id="section-4-5.4">A generic composite OID is provided for implementers who wish to use combinations not listed here, without the overhead of defining new OIDs. Caution should be exercised to avoid issues with compatibility and complex cryptographic policy mechanisms.<a href="#section-4-5.4" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-4-6">The authors wish to note that although the CompositePublicKey and CompositePrivateKey structures are defined in such a way as to easily allow 3 or more component keys, it was decided at the time of writing to only specify explicit pairs. The generic composite algorithms specified in <a href="#sec-generic-composite-kem-shake128" class="xref">Section 4.11</a> and <a href="#sec-generic-composite-kem-shake256" class="xref">Section 4.12</a> of course allows for an arbitrary number of components. This also does not preclude future specification of explicit combinations with three or more components.<a href="#section-4-6" class="pilcrow">¶</a></p>
<div id="sec-id-Kyber512-ECDH-P256-SHAKE128">
<section id="section-4.1">
        <h3 id="name-id-kyber512-ecdh-p256-shake1">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-id-kyber512-ecdh-p256-shake1" class="section-name selfRef">id-Kyber512-ECDH-P256-SHAKE128</a>
        </h3>
<p id="section-4.1-1">This composite KEM algorithm MAY be used with a <code>id-Kyber512-ECDH-P256</code> composite key as defined in <span>[<a href="#I-D.ounsworth-pq-composite-keys" class="xref">I-D.ounsworth-pq-composite-keys</a>]</span>, or MAY be used with Kyber512 and EC P256 keys from independant sources, for example independant certificates, software or hardware keystores.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
id-alg-composite-kem OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) Algorithm(80) ExplicitComposite(5) KEM5(2)
  TBD }
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">EDNOTE: this is a temporary OID for the purposes of prototyping.  We
   are requesting IANA to assign a permanent OID, see Section 6.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">AlgorithmIdentifier paramaters are ABSENT.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">The first componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the 256-bit encapsulated key (ciphertext) of the Kyber512 algorithm as per TODO: cite NIST FIPS spec. <code>ss1</code> SHALL be the shared secret corresponding to the first ciphertext.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">The second componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the sender's secp256r1 public key as defied in <span>[<a href="#RFC5480" class="xref">RFC5480</a>]</span>. <code>ss2</code> SHALL be the shared secret derived from applying Elliptic Curve Cryptography Cofactor Diffie-Hellman (ECC CDH) as defined in section 5.7.1.2 of <span>[<a href="#SP.800-56Ar3" class="xref">SP.800-56Ar3</a>]</span> to the other party's public key and one's own secp256r1 private key. SBecause this ECDH variant outputs directly the x coordinate of the shared point, we apply a hash function to extract a uniformly random secret from it.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">The output of the two component KEMs is to be combined as follows:<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-8">
<pre>
ss = SHAKE128( ss1 || SHAKE128(ss2, 256) , 256)
</pre><a href="#section-4.1-8" class="pilcrow">¶</a>
</div>
<p id="section-4.1-9">where SHAKE128(M, 256) describes the use of the SHAKE128 as specified in <span>[<a href="#SHA3" class="xref">SHA3</a>]</span> with a 256 bit output.<a href="#section-4.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-id-Kyber512-ECDH-brainpoolP256r1-shake128">
<section id="section-4.2">
        <h3 id="name-id-kyber512-ecdh-brainpoolp2">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-id-kyber512-ecdh-brainpoolp2" class="section-name selfRef">id-Kyber512-ECDH-brainpoolP256r1-shake128</a>
        </h3>
<p id="section-4.2-1">This composite KEM algorithm MAY be used with a <code>id-Kyber512-ECDH-brainpoolP256r1</code> composite key as defined in <span>[<a href="#I-D.ounsworth-pq-composite-keys" class="xref">I-D.ounsworth-pq-composite-keys</a>]</span>, or MAY be used with Kyber512 and EC P256 keys from independant sources, for example independant certificates, software or hardware keystores.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-2">
<pre>
id-alg-composite-kem OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) Algorithm(80) TBD }
</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2-3">EDNOTE: this is a temporary OID for the purposes of prototyping.  We
   are requesting IANA to assign a permanent OID, see Section 6.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">AlgorithmIdentifier paramaters are ABSENT.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">The first componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the 256-bit encapsulated key (ciphertext) of the Kyber512 algorithm as per TODO: cite NIST FIPS spec. <code>ss1</code> SHALL be the shared secret corresponding to the first ciphertext.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">The second componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the the sender's brainpoolP256r1 public key as defied in <span>[<a href="#RFC5639" class="xref">RFC5639</a>]</span>. <code>ss2</code> SHALL be the shared secret derived from applying the elliptic curve key agreement algorithm (ECKA) as defined in section 4.3.1 of <span>[<a href="#BSI-ECC" class="xref">BSI-ECC</a>]</span> to the other party's public key and one's own brainpoolP256r1 private key. Note that <span>[<a href="#BSI-ECC" class="xref">BSI-ECC</a>]</span> states: "The shared secret value Z_AB MUST NOT be used directly for encryption or integrity protection, key derivation functions are described in Section 4.3.3." and therefore, unlike the NIST ECDH variant, we concatenate <code>ss2</code> directly with <code>ss1</code>.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">The output of the two component KEMs is to be combined as follows:<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-8">
<pre>
ss = SHAKE128( ss1 || ss2, 256)
</pre><a href="#section-4.2-8" class="pilcrow">¶</a>
</div>
<p id="section-4.2-9">where SHAKE128(M, 256) describes the use of the SHAKE128 as specified in <span>[<a href="#SHA3" class="xref">SHA3</a>]</span> with a 256 bit output.<a href="#section-4.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-id-Kyber512-X25519-shake128">
<section id="section-4.3">
        <h3 id="name-id-kyber512-x25519-shake128-2">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-id-kyber512-x25519-shake128-2" class="section-name selfRef">id-Kyber512-X25519-shake128</a>
        </h3>
<p id="section-4.3-1">This composite KEM algorithm MAY be used with a <code>id-Kyber512-X25519</code> composite key as defined in <span>[<a href="#I-D.ounsworth-pq-composite-keys" class="xref">I-D.ounsworth-pq-composite-keys</a>]</span>, or MAY be used with Kyber512 and X25519 keys from independant sources, for example independant certificates, software or hardware keystores.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-2">
<pre>
id-alg-composite-kem OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) Algorithm(80) TBD }
</pre><a href="#section-4.3-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3-3">EDNOTE: this is a temporary OID for the purposes of prototyping.  We
   are requesting IANA to assign a permanent OID, see Section 6.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">AlgorithmIdentifier paramaters are ABSENT.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">The first componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the 256-bit encapsulated key (ciphertext) of the Kyber512 algorithm as per TODO: cite NIST FIPS spec. <code>ss1</code> SHALL be the shared secret corresponding to the first ciphertext.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3-6">The second componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the sender's X25519 public key as defied in <span>[<a href="#RFC8410" class="xref">RFC8410</a>]</span>. <code>ss2</code> SHALL be the shared secret derived from applying X25519 as defined in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span> to the other party's public key and one's own X25519 private key.<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3-7">The output of the two component KEMs is to be combined as follows:<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-8">
<pre>
ss = SHAKE128( ss1 || ss2, 256)
</pre><a href="#section-4.3-8" class="pilcrow">¶</a>
</div>
<p id="section-4.3-9">where SHAKE128(M, 256) describes the use of the SHAKE128 as specified in <span>[<a href="#SHA3" class="xref">SHA3</a>]</span> with a 256 bit output.<a href="#section-4.3-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-id-Kyber768-RSA-shake256">
<section id="section-4.4">
        <h3 id="name-id-kyber768-rsa-shake256-2">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-id-kyber768-rsa-shake256-2" class="section-name selfRef">id-Kyber768-RSA-shake256</a>
        </h3>
<p id="section-4.4-1">This composite KEM algorithm MAY be used with a <code>id-Kyber768-RSA</code> composite key as defined in <span>[<a href="#I-D.ounsworth-pq-composite-keys" class="xref">I-D.ounsworth-pq-composite-keys</a>]</span>, or MAY be used with Kyber768 and RSA keys from independant sources, for example independant certificates, software or hardware keystores.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-2">
<pre>
id-alg-composite-kem OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) Algorithm(80) TBD }
</pre><a href="#section-4.4-2" class="pilcrow">¶</a>
</div>
<p id="section-4.4-3">EDNOTE: this is a temporary OID for the purposes of prototyping.  We
   are requesting IANA to assign a permanent OID, see Section 6.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">AlgorithmIdentifier paramaters are ABSENT.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<p id="section-4.4-5">--- BEGIN EDNOTE ---
TODO: this needs some thought. We probably want to just point to RSA-KEM RFC5990, but we don't have an existing key to transport, so we only need steps 1 - 3 as defined in RFC5990 A.2.<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<p id="section-4.4-6">We need to carry the RSA-KEM params:<a href="#section-4.4-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-7">
<pre>
  GenericHybridParameters ::= {
     kem  KeyEncapsulationMechanism,
     dem  DataEncapsulationMechanism
  }
</pre><a href="#section-4.4-7" class="pilcrow">¶</a>
</div>
<p id="section-4.4-8">We should probably set the KDF params to implicitely to match the KEM combiner: KDF=SHAKE256, keyLength=384 and omit the params.<a href="#section-4.4-8" class="pilcrow">¶</a></p>
<p id="section-4.4-9">RsaKemParameters ::= {
               keyDerivationFunction  KeyDerivationFunction,
               keyLength              KeyLength
            }<a href="#section-4.4-9" class="pilcrow">¶</a></p>
<p id="section-4.4-10">--- END EDNOTE ---<a href="#section-4.4-10" class="pilcrow">¶</a></p>
<p id="section-4.4-11">The first componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the X-bit ?? (TODO: I assume it's 384?) encapsulated key (ciphertext) of the Kyber768 algorithm as per TODO: cite NIST FIPS spec. <code>ss1</code> SHALL be the shared secret corresponding to the first ciphertext.<a href="#section-4.4-11" class="pilcrow">¶</a></p>
<p id="section-4.4-12">The second componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the ciphertext <code>C</code> as defined in <span>[<a href="#RFC5990" class="xref">RFC5990</a>]</span> appendix A.2. <code>ss2</code> SHALL be the shared secret <code>Z</code> as defined in <span>[<a href="#RFC5990" class="xref">RFC5990</a>]</span>. Since <code>Z</code> variant is directly a field element, we need to mask it with a KDF prior to combining it with the other shared secret.<a href="#section-4.4-12" class="pilcrow">¶</a></p>
<p id="section-4.4-13">The output of the two component KEMs is to be combined as follows:<a href="#section-4.4-13" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-14">
<pre>
ss = SHAKE256( ss1 || SHAKE256(ss2, 384), 384)
</pre><a href="#section-4.4-14" class="pilcrow">¶</a>
</div>
<p id="section-4.4-15">where SHAKE256(M, 384) describes the use of the SHAKE256 as specified in <span>[<a href="#SHA3" class="xref">SHA3</a>]</span> with a 384 bit output.<a href="#section-4.4-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-id-Kyber768-ECDH-P256-shake256">
<section id="section-4.5">
        <h3 id="name-id-kyber768-ecdh-p256-shake2">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-id-kyber768-ecdh-p256-shake2" class="section-name selfRef">id-Kyber768-ECDH-P256-shake256</a>
        </h3>
<p id="section-4.5-1">This composite KEM algorithm MAY be used with a <code>id-Kyber768-ECDH-P256</code> composite key as defined in <span>[<a href="#I-D.ounsworth-pq-composite-keys" class="xref">I-D.ounsworth-pq-composite-keys</a>]</span>, or MAY be used with Kyber768 and EC P256 keys from independant sources, for example independant certificates, software or hardware keystores.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-2">
<pre>
id-alg-composite-kem OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) Algorithm(80) ExplicitComposite(5) KEM5(2)
  TBD }
</pre><a href="#section-4.5-2" class="pilcrow">¶</a>
</div>
<p id="section-4.5-3">EDNOTE: this is a temporary OID for the purposes of prototyping.  We
   are requesting IANA to assign a permanent OID, see Section 6.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">AlgorithmIdentifier paramaters are ABSENT.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<p id="section-4.5-5">The first componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the X-bit ?? (TODO: I assume it's 384?) encapsulated key (ciphertext) of the Kyber768 algorithm as per TODO: cite NIST FIPS spec. <code>ss1</code> SHALL be the shared secret corresponding to the first ciphertext.<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<p id="section-4.5-6">The second componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the sender's secp256r1 public key as defied in <span>[<a href="#RFC5480" class="xref">RFC5480</a>]</span>. <code>ss2</code> SHALL be the shared secret derived from applying Elliptic Curve Cryptography Cofactor Diffie-Hellman (ECC CDH) as defined in section 5.7.1.2 of <span>[<a href="#SP.800-56Ar3" class="xref">SP.800-56Ar3</a>]</span> to the other party's public key and one's own secp256r1 private key. Because this ECDH variant outputs directly the x coordinate of the shared point, we apply a hash function to extract a uniformly random secret from it.<a href="#section-4.5-6" class="pilcrow">¶</a></p>
<p id="section-4.5-7">The output of the two component KEMs is to be combined as follows:<a href="#section-4.5-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-8">
<pre>
ss = SHAKE256( ss1 || SHAKE256(ss2, 384), 384)
</pre><a href="#section-4.5-8" class="pilcrow">¶</a>
</div>
<p id="section-4.5-9">where SHAKE256(M, 384) describes the use of the SHAKE256 as specified in <span>[<a href="#SHA3" class="xref">SHA3</a>]</span> with a 384 bit output.<a href="#section-4.5-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-id-Kyber768-ECDH-brainpoolP256r1-shake256">
<section id="section-4.6">
        <h3 id="name-id-kyber768-ecdh-brainpoolp2">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-id-kyber768-ecdh-brainpoolp2" class="section-name selfRef">id-Kyber768-ECDH-brainpoolP256r1-shake256</a>
        </h3>
<p id="section-4.6-1">This composite KEM algorithm MAY be used with a <code>id-Kyber768-ECDH-brainpoolP256r1</code> composite key as defined in <span>[<a href="#I-D.ounsworth-pq-composite-keys" class="xref">I-D.ounsworth-pq-composite-keys</a>]</span>, or MAY be used with Kyber768 and EC P256 keys from independant sources, for example independant certificates, software or hardware keystores.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.6-2">
<pre>
id-alg-composite-kem OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) Algorithm(80) TBD }
</pre><a href="#section-4.6-2" class="pilcrow">¶</a>
</div>
<p id="section-4.6-3">EDNOTE: this is a temporary OID for the purposes of prototyping.  We
   are requesting IANA to assign a permanent OID, see Section 6.<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<p id="section-4.6-4">AlgorithmIdentifier paramaters are ABSENT.<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<p id="section-4.6-5">The first componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the X-bit ?? (TODO: I assume it's 384?) encapsulated key (ciphertext) of the Kyber768 algorithm as per TODO: cite NIST FIPS spec. <code>ss1</code> SHALL be the shared secret corresponding to the first ciphertext.<a href="#section-4.6-5" class="pilcrow">¶</a></p>
<p id="section-4.6-6">The second componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the the sender's brainpoolP256r1 public key as defied in <span>[<a href="#RFC5639" class="xref">RFC5639</a>]</span>. <code>ss2</code> SHALL be the shared secret derived from applying the elliptic curve key agreement algorithm (ECKA) as defined in section 4.3.1 of <span>[<a href="#BSI-ECC" class="xref">BSI-ECC</a>]</span> to the other party's public key and one's own brainpoolP256r1 private key. Note that <span>[<a href="#BSI-ECC" class="xref">BSI-ECC</a>]</span> states: "The shared secret value Z_AB MUST NOT be used directly for encryption or integrity protection, key derivation functions are described in Section 4.3.3." and therefore, unlike the NIST ECDH variant, we concatenate <code>ss2</code> directly with <code>ss1</code>.<a href="#section-4.6-6" class="pilcrow">¶</a></p>
<p id="section-4.6-7">The output of the two component KEMs is to be combined as follows:<a href="#section-4.6-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.6-8">
<pre>
ss = SHAKE256( ss1 || ss2, 384)
</pre><a href="#section-4.6-8" class="pilcrow">¶</a>
</div>
<p id="section-4.6-9">where SHAKE256(M, 384) describes the use of the SHAKE256 as specified in <span>[<a href="#SHA3" class="xref">SHA3</a>]</span> with a 384 bit output.<a href="#section-4.6-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-id-Kyber768-X25519-shake256">
<section id="section-4.7">
        <h3 id="name-id-kyber768-x25519-shake256-2">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-id-kyber768-x25519-shake256-2" class="section-name selfRef">id-Kyber768-X25519-shake256</a>
        </h3>
<p id="section-4.7-1">This composite KEM algorithm MAY be used with a <code>id-Kyber768-X25519</code> composite key as defined in <span>[<a href="#I-D.ounsworth-pq-composite-keys" class="xref">I-D.ounsworth-pq-composite-keys</a>]</span>, or MAY be used with Kyber768 and X25519 keys from independant sources, for example independant certificates, software or hardware keystores.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.7-2">
<pre>
id-alg-composite-kem OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) Algorithm(80) TBD }
</pre><a href="#section-4.7-2" class="pilcrow">¶</a>
</div>
<p id="section-4.7-3">EDNOTE: this is a temporary OID for the purposes of prototyping.  We
   are requesting IANA to assign a permanent OID, see Section 6.<a href="#section-4.7-3" class="pilcrow">¶</a></p>
<p id="section-4.7-4">AlgorithmIdentifier paramaters are ABSENT.<a href="#section-4.7-4" class="pilcrow">¶</a></p>
<p id="section-4.7-5">The first componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the X-bit ?? (TODO: I assume it's 384?) encapsulated key (ciphertext) of the Kyber768 algorithm as per TODO: cite NIST FIPS spec. <code>ss1</code> SHALL be the shared secret corresponding to the first ciphertext.<a href="#section-4.7-5" class="pilcrow">¶</a></p>
<p id="section-4.7-6">The second componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the sender's X25519 public key as defied in <span>[<a href="#RFC8410" class="xref">RFC8410</a>]</span>. <code>ss2</code> SHALL be the shared secret derived from applying X25519 as defined in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span> to the other party's public key and one's own X25519 private key.<a href="#section-4.7-6" class="pilcrow">¶</a></p>
<p id="section-4.7-7">The output of the two component KEMs is to be combined as follows:<a href="#section-4.7-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.7-8">
<pre>
ss = SHAKE256( ss1 || ss2, 384)
</pre><a href="#section-4.7-8" class="pilcrow">¶</a>
</div>
<p id="section-4.7-9">where SHAKE256(M, 384) describes the use of the SHAKE256 as specified in <span>[<a href="#SHA3" class="xref">SHA3</a>]</span> with a 384 bit output.<a href="#section-4.7-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-id-Kyber1024-ECDH-P384-shake256">
<section id="section-4.8">
        <h3 id="name-id-kyber1024-ecdh-p384-shake">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-id-kyber1024-ecdh-p384-shake" class="section-name selfRef">id-Kyber1024-ECDH-P384-shake256</a>
        </h3>
<p id="section-4.8-1">This composite KEM algorithm MAY be used with a <code>id-Kyber1024-ECDH-P384</code> composite key as defined in <span>[<a href="#I-D.ounsworth-pq-composite-keys" class="xref">I-D.ounsworth-pq-composite-keys</a>]</span>, or MAY be used with Kyber768 and EC P256 keys from independant sources, for example independant certificates, software or hardware keystores.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.8-2">
<pre>
id-alg-composite-kem OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) Algorithm(80) ExplicitComposite(5) KEM5(2)
  TBD }
</pre><a href="#section-4.8-2" class="pilcrow">¶</a>
</div>
<p id="section-4.8-3">EDNOTE: this is a temporary OID for the purposes of prototyping.  We
   are requesting IANA to assign a permanent OID, see Section 6.<a href="#section-4.8-3" class="pilcrow">¶</a></p>
<p id="section-4.8-4">AlgorithmIdentifier paramaters are ABSENT.<a href="#section-4.8-4" class="pilcrow">¶</a></p>
<p id="section-4.8-5">The first componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the X-bit ?? (TODO: I assume it's 512?) encapsulated key (ciphertext) of the Kyber768 algorithm as per TODO: cite NIST FIPS spec. <code>ss1</code> SHALL be the shared secret corresponding to the first ciphertext.<a href="#section-4.8-5" class="pilcrow">¶</a></p>
<p id="section-4.8-6">The second componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the sender's secp384r1 public key as defied in <span>[<a href="#RFC5480" class="xref">RFC5480</a>]</span>. <code>ss2</code> SHALL be the shared secret derived from applying Elliptic Curve Cryptography Cofactor Diffie-Hellman (ECC CDH) as defined in section 5.7.1.2 of <span>[<a href="#SP.800-56Ar3" class="xref">SP.800-56Ar3</a>]</span> to the other party's public key and one's own secp384r1 private key. Because this ECDH variant outputs directly the x coordinate of the shared point, we apply a hash function to extract a uniformly random secret from it.<a href="#section-4.8-6" class="pilcrow">¶</a></p>
<p id="section-4.8-7">The output of the two component KEMs is to be combined as follows:<a href="#section-4.8-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.8-8">
<pre>
ss = SHAKE256( ss1 || SHAKE256(ss2, 512), 512)
</pre><a href="#section-4.8-8" class="pilcrow">¶</a>
</div>
<p id="section-4.8-9">where SHAKE256(M, 512) describes the use of the SHAKE256 as specified in <span>[<a href="#SHA3" class="xref">SHA3</a>]</span> with a 512 bit output.<a href="#section-4.8-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-id-Kyber1024-ECDH-brainpoolP384r1-shake256">
<section id="section-4.9">
        <h3 id="name-id-kyber1024-ecdh-brainpoolp">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-id-kyber1024-ecdh-brainpoolp" class="section-name selfRef">id-Kyber1024-ECDH-brainpoolP384r1-shake256</a>
        </h3>
<p id="section-4.9-1">This composite KEM algorithm MAY be used with a <code>id-Kyber1024-ECDH-brainpoolP384r1</code> composite key as defined in <span>[<a href="#I-D.ounsworth-pq-composite-keys" class="xref">I-D.ounsworth-pq-composite-keys</a>]</span>, or MAY be used with Kyber768 and EC P256 keys from independant sources, for example independant certificates, software or hardware keystores.<a href="#section-4.9-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.9-2">
<pre>
id-alg-composite-kem OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) Algorithm(80) TBD }
</pre><a href="#section-4.9-2" class="pilcrow">¶</a>
</div>
<p id="section-4.9-3">EDNOTE: this is a temporary OID for the purposes of prototyping.  We
   are requesting IANA to assign a permanent OID, see Section 6.<a href="#section-4.9-3" class="pilcrow">¶</a></p>
<p id="section-4.9-4">AlgorithmIdentifier paramaters are ABSENT.<a href="#section-4.9-4" class="pilcrow">¶</a></p>
<p id="section-4.9-5">The first componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the X-bit ?? (TODO: I assume it's 384?) encapsulated key (ciphertext) of the Kyber768 algorithm as per TODO: cite NIST FIPS spec. <code>ss1</code> SHALL be the shared secret corresponding to the first ciphertext.<a href="#section-4.9-5" class="pilcrow">¶</a></p>
<p id="section-4.9-6">The second componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the the sender's brainpoolP384r1 public key as defied in <span>[<a href="#RFC5639" class="xref">RFC5639</a>]</span>. <code>ss2</code> SHALL be the shared secret derived from applying the elliptic curve key agreement algorithm (ECKA) as defined in section 4.3.1 of <span>[<a href="#BSI-ECC" class="xref">BSI-ECC</a>]</span> to the other party's public key and one's own brainpoolP384r1 private key. Note that <span>[<a href="#BSI-ECC" class="xref">BSI-ECC</a>]</span> states: "The shared secret value Z_AB MUST NOT be used directly for encryption or integrity protection, key derivation functions are described in Section 4.3.3." and therefore, unlike the NIST ECDH variant, we concatenate <code>ss2</code> directly with <code>ss1</code>.<a href="#section-4.9-6" class="pilcrow">¶</a></p>
<p id="section-4.9-7">The output of the two component KEMs is to be combined as follows:<a href="#section-4.9-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.9-8">
<pre>
ss = SHAKE256( ss1 || ss2, 512)
</pre><a href="#section-4.9-8" class="pilcrow">¶</a>
</div>
<p id="section-4.9-9">where SHAKE256(M, 512) describes the use of the SHAKE256 as specified in <span>[<a href="#SHA3" class="xref">SHA3</a>]</span> with a 512 bit output.<a href="#section-4.9-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-id-Kyber1024-X448-shake256">
<section id="section-4.10">
        <h3 id="name-id-kyber1024-x448-shake256-2">
<a href="#section-4.10" class="section-number selfRef">4.10. </a><a href="#name-id-kyber1024-x448-shake256-2" class="section-name selfRef">id-Kyber1024-X448-shake256</a>
        </h3>
<p id="section-4.10-1">This composite KEM algorithm MAY be used with a <code>id-Kyber1024-X448</code> composite key as defined in <span>[<a href="#I-D.ounsworth-pq-composite-keys" class="xref">I-D.ounsworth-pq-composite-keys</a>]</span>, or MAY be used with Kyber1024 and X448 keys from independant sources, for example independant certificates, software or hardware keystores.<a href="#section-4.10-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.10-2">
<pre>
id-alg-composite-kem OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) Algorithm(80) TBD }
</pre><a href="#section-4.10-2" class="pilcrow">¶</a>
</div>
<p id="section-4.10-3">EDNOTE: this is a temporary OID for the purposes of prototyping.  We
   are requesting IANA to assign a permanent OID, see Section 6.<a href="#section-4.10-3" class="pilcrow">¶</a></p>
<p id="section-4.10-4">AlgorithmIdentifier paramaters are ABSENT.<a href="#section-4.10-4" class="pilcrow">¶</a></p>
<p id="section-4.10-5">The first componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the X-bit ?? (TODO: I assume it's 512?) encapsulated key (ciphertext) of the Kyber1024 algorithm as per TODO: cite NIST FIPS spec. <code>ss1</code> SHALL be the shared secret corresponding to the first ciphertext.<a href="#section-4.10-5" class="pilcrow">¶</a></p>
<p id="section-4.10-6">The second componet BIT STRING within <code>CompositeCiphertextValue</code> SHALL be the sender's X448 public key as defied in <span>[<a href="#RFC8410" class="xref">RFC8410</a>]</span>. <code>ss2</code> SHALL be the shared secret derived from applying X448 as defined in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span> to the other party's public key and one's own X448 private key.<a href="#section-4.10-6" class="pilcrow">¶</a></p>
<p id="section-4.10-7">The output of the two component KEMs is to be combined as follows:<a href="#section-4.10-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.10-8">
<pre>
ss = SHAKE256( ss1 || SHAKE256(ss2, 512), 512)
</pre><a href="#section-4.10-8" class="pilcrow">¶</a>
</div>
<p id="section-4.10-9">where SHAKE256(M, 512) describes the use of the SHAKE256 as specified in <span>[<a href="#SHA3" class="xref">SHA3</a>]</span> with a 512 bit output.<a href="#section-4.10-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-generic-composite-kem-shake128">
<section id="section-4.11">
        <h3 id="name-id-alg-composite-kem-shake12">
<a href="#section-4.11" class="section-number selfRef">4.11. </a><a href="#name-id-alg-composite-kem-shake12" class="section-name selfRef">id-alg-composite-kem-shake128</a>
        </h3>
<p id="section-4.11-1">The <code>id-alg-composite-kem-SHAKE128</code> object identifier is used for identifying a generic composite KEM algorithm. This allows arbitrary combinations of component key transport, key agreement and KEM algorithms without needing the combination to be pre-registered or standardized. This generic KEM composite algorithm uses SHAKE128 as the KEM combiner and so is intended for use with component KEM algorithms that target the 128 bit security level. For combining KEM algorithms at higher security levels, it is recommended to use <code>id-alg-composite-kem-shake256</code> defined in <a href="#sec-generic-composite-kem-shake256" class="xref">Section 4.12</a>.<a href="#section-4.11-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.11-2">
<pre>
id-alg-composite-kem-SHAKE128 OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) Algorithm(80) Composite(4) KEM (5) }
</pre><a href="#section-4.11-2" class="pilcrow">¶</a>
</div>
<p id="section-4.11-3">EDNOTE: this is a temporary OID for the purposes of prototyping.  We
   are requesting IANA to assign a permanent OID, see Section 6.<a href="#section-4.11-3" class="pilcrow">¶</a></p>
<p id="section-4.11-4">EDNOTE: does the (generic) params need to also carry a list of AlgorithmIdentifiers that were used in the encryption? With signatures we need this to prevent the verifier from coming up with false validity by using the wrong verification algorithm(s). With encryption I think it's less important because either your private key works or it doesn't, no harm done by trying to decrypt with the wrong alg. So the question is: is it useful as a hint to the decrypter?<a href="#section-4.11-4" class="pilcrow">¶</a></p>
<p id="section-4.11-5">This composite KEM algorithm MAY be used with a <code>id-composite-key</code> composite key as defined in <span>[<a href="#I-D.ounsworth-pq-composite-keys" class="xref">I-D.ounsworth-pq-composite-keys</a>]</span>, prodived that it carries a carries a <code>keyUsage</code> of <code>keyEncipherment</code> or <code>keyAgreement</code> and contains component keys of corresponding approriate types. This composite KEM algorithm MAY also be used with <code>keyEncipherment</code> or <code>keyAgreement</code> type keys from independant sources, for example independant certificates, software or hardware keystores.<a href="#section-4.11-5" class="pilcrow">¶</a></p>
<p id="section-4.11-6">When using this generic composite mode, the application is responsible for determining the contents and order of the <code>CompositeCihprtextValue</code>s.<a href="#section-4.11-6" class="pilcrow">¶</a></p>
<p id="section-4.11-7">In general we do not know if it is safe to use the component shared secrets directly, so we wrap both with a KDF in the following KEM combiner:<a href="#section-4.11-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.11-8">
<pre>
ss = SHAKE128( SHAKE128(ss1, 256) || SHAKE128(ss2, 256) , 256)
</pre><a href="#section-4.11-8" class="pilcrow">¶</a>
</div>
<p id="section-4.11-9">where SHAKE128(M, 256) describes the use of the SHAKE128 as specified in <span>[<a href="#SHA3" class="xref">SHA3</a>]</span> with a 256 bit output.<a href="#section-4.11-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-generic-composite-kem-shake256">
<section id="section-4.12">
        <h3 id="name-id-alg-composite-kem-shake25">
<a href="#section-4.12" class="section-number selfRef">4.12. </a><a href="#name-id-alg-composite-kem-shake25" class="section-name selfRef">id-alg-composite-kem-shake256</a>
        </h3>
<p id="section-4.12-1">The id-alg-composite-kem object identifier is used for identifying a generic composite KEM algorithm. This allows arbitrary combinations of component key transport, key agreement and KEM algorithms without needing the combination to be pre-registered or standardized.<a href="#section-4.12-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.12-2">
<pre>
id-alg-composite-kem OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) Algorithm(80) Composite(4) KEM (??) }
</pre><a href="#section-4.12-2" class="pilcrow">¶</a>
</div>
<p id="section-4.12-3">EDNOTE: this is a temporary OID for the purposes of prototyping.  We
   are requesting IANA to assign a permanent OID, see Section 6.<a href="#section-4.12-3" class="pilcrow">¶</a></p>
<p id="section-4.12-4">TODO: update the Entrust registry to make this <code>KEM-SHAKE128 / KEM-SHAKE256</code>.<a href="#section-4.12-4" class="pilcrow">¶</a></p>
<p id="section-4.12-5">EDNOTE: does the (generic) params need to also carry a list of AlgorithmIdentifiers that were used in the encryption? With signatures we need this to prevent the verifier from coming up with false validity by using the wrong verification algorithm(s). With encryption I think it's less important because either your private key works or it doesn't, no harm done by trying to decrypt with the wrong alg. So the question is: is it useful as a hint to the decrypter?<a href="#section-4.12-5" class="pilcrow">¶</a></p>
<p id="section-4.12-6">This composite KEM algorithm MAY be used with a <code>id-composite-key</code> composite key as defined in <span>[<a href="#I-D.ounsworth-pq-composite-keys" class="xref">I-D.ounsworth-pq-composite-keys</a>]</span>, prodived that it carries a carries a <code>keyUsage</code> of <code>keyEncipherment</code> or <code>keyAgreement</code> and contains component keys of corresponding approriate types. This composite KEM algorithm MAY also be used with <code>keyEncipherment</code> or <code>keyAgreement</code> type keys from independant sources, for example independant certificates, software or hardware keystores.<a href="#section-4.12-6" class="pilcrow">¶</a></p>
<p id="section-4.12-7">When using this generic composite mode, the application is responsible for determining the contents and order of the <code>CompositeCihprtextValue</code>s.<a href="#section-4.12-7" class="pilcrow">¶</a></p>
<p id="section-4.12-8">In general we do not know if it is safe to use the component shared secrets directly, so we wrap both with a KDF in the following KEM combiner:<a href="#section-4.12-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.12-9">
<pre>
ss = SHAKE256( SHAKE256(ss1, 512) || SHAKE256(ss2, 512) , 512)
</pre><a href="#section-4.12-9" class="pilcrow">¶</a>
</div>
<p id="section-4.12-10">where SHAKE256(M, 512) describes the use of the SHAKE256 as specified in <span>[<a href="#SHA3" class="xref">SHA3</a>]</span> with a 512 bit output.<a href="#section-4.12-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-in-pract">
<section id="section-5">
      <h2 id="name-in-practice-2">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-in-practice-2" class="section-name selfRef">In Practice</a>
      </h2>
<p id="section-5-1">This section addresses practical issues of how this draft affects other protocols and standards.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">EDNOTE 10: Possible topics to address:<a href="#section-5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-3.1">The size of these certs and cert chains.<a href="#section-5-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-3.2">In particular, implications for (large) composite keys / signatures / certs on the handshake stages of TLS and IKEv2.<a href="#section-5-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-3.3">If a cert in the chain is a composite cert then does the whole chain need to be of composite Certs?<a href="#section-5-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-3.4">We could also explain that the root CA cert does not have to be of the same algorithms. The root cert SHOULD NOT be transferred in the authentication exchange to save transport overhead and thus it can be different than the intermediate and leaf certs.<a href="#section-5-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-3.5">We could talk about overhead (size and processing).<a href="#section-5-3.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-3.6">We could also discuss backwards compatibility.<a href="#section-5-3.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-3.7">We could include a subsection about implementation considerations.<a href="#section-5-3.7" class="pilcrow">¶</a>
</li>
      </ul>
<div id="sec-backwards-compat">
<section id="section-5.1">
        <h3 id="name-backwards-compatibility-2">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-backwards-compatibility-2" class="section-name selfRef">Backwards Compatibility</a>
        </h3>
<p id="section-5.1-1">As noted in the introduction, the post-quantum cryptographic migration will face challenges in both ensuring cryptographic strength against adversaries of unknown capabilities, as well as providing ease of migration. The composite mechanisms defined in this document primarily address cryptographic strength, however this section contains notes on how backwards compatibility may be obtained.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The term "ease of migration" is used here to mean that existing systems can be gracefully transitioned to the new technology without requiring large service disruptions or expensive upgrades. The term "backwards compatibility" is used here to mean something more specific; that existing systems as they are deployed today can interoperate with the upgraded systems of the future.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">These migration and interoperability concerns need to be thought about in the context of various types of protocols that make use of X.509 and PKIX with relation to key establishment and content encryption, from online negotiated protocols such as TLS 1.3 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> and IKEv2 <span>[<a href="#RFC7296" class="xref">RFC7296</a>]</span>, to non-negotiated asynchronous protocols such as S/MIME signed email <span>[<a href="#RFC8551" class="xref">RFC8551</a>]</span>, as well as myriad other standardized and proprietary protocols and applications that leverage CMS <span>[<a href="#RFC5652" class="xref">RFC5652</a>]</span> encrypted structures.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<div id="k-of-n-modes">
<section id="section-5.1.1">
          <h4 id="name-k-of-n-modes-2">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-k-of-n-modes-2" class="section-name selfRef">K-of-N modes</a>
          </h4>
<p id="section-5.1.1-1">~~~ BEGIN EDNOTE ~~~
In the context of encryption, K-of-N modes could mean one of two things:<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">Type 1: sender uses a subset<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1.1-3">This would mean the sender (encrypter) uses a subset of K the N component keys within the receiver's public key. The obvious way to combine them is with skipping the unused keys / algorithms and emitting a NULL ciphertext in their place. This mechanism is straight-forward and allows ease of migration where a sender encounters a composite encryption public key where it does not support all component algorithms. It also supports performance optimization where, for example, a receiver can be issued a key with many component keys and a sender can choose the highest-performance subset that are still considered safe.<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1.1-4">Type 2: receiver uses a subset<a href="#section-5.1.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1.1-5">This would mean that the sender (encrypter) uses all N of the component keys within the receiver's public key in such a way that the receiver (decrypter) only needs to use K private keys to decrypt the message. This implies the need for some kind of Shamir's-like secret splitting scheme. This is a reasonably complex mechanism and it's currently unclear if there are any use-cases that require such a mechanism.<a href="#section-5.1.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1.1-6">~~~ END EDNOTE ~~~<a href="#section-5.1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="parallel-pkis">
<section id="section-5.1.2">
          <h4 id="name-parallel-pkis-2">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-parallel-pkis-2" class="section-name selfRef">Parallel PKIs</a>
          </h4>
<p id="section-5.1.2-1">We present the term "Parallel PKI" to refer to the setup where a PKI end entity possesses two or more distinct public keys or certificates for the same identity (name), but containing keys for different cryptographic algorithms. One could imagine a set of parallel PKIs where an existing PKI using legacy algorithms (RSA, ECC) is left operational during the post-quantum migration but is shadowed by one or more parallel PKIs using pure post quantum algorithms or composite algorithms (legacy and post-quantum).<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">Equipped with a set of parallel public keys in this way, a client would have the flexibility to choose which public key(s) or certificate(s) to use in a given signature operation.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.1.2-3">For negotiated protocols, the client could choose which public key(s) or certificate(s) to use based on the negotiated algorithms.<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<p id="section-5.1.2-4">For non-negotiated protocols, the details for obtaining backwards compatibility will vary by protocol, but for example in CMS <span>[<a href="#RFC5652" class="xref">RFC5652</a>]</span>.<a href="#section-5.1.2-4" class="pilcrow">¶</a></p>
<p id="section-5.1.2-5">EDNOTE: I copied and pruned this text from <span>[<a href="#I-D.ounsworth-pq-composite-sigs" class="xref">I-D.ounsworth-pq-composite-sigs</a>]</span>. It probably needs to be fleshed out more as we better understand the implementation concerns around composite encryption.<a href="#section-5.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-iana">
<section id="section-6">
      <h2 id="name-iana-considerations-2">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations-2" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">The ASN.1 module OID is TBD.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations-2">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations-2" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="policy-for-deprecated-and-acceptable-algorithms">
<section id="section-7.1">
        <h3 id="name-policy-for-deprecated-and-ac">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-policy-for-deprecated-and-ac" class="section-name selfRef">Policy for Deprecated and Acceptable Algorithms</a>
        </h3>
<p id="section-7.1-1">Traditionally, a public key, certificate, or signature contains a single cryptographic algorithm. If and when an algorithm becomes deprecated (for example, RSA-512, or SHA1), it is obvious that structures using that algorithm are implicitly revoked.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">In the composite model this is less obvious since implementers may decide that certain cryptographic algorithms have complementary security properties and are acceptable in combination even though one or both algorithms are deprecated for individual use. As such, a single composite public key, certificate, signature, or ciphertext may contain a mixture of deprecated and non-deprecated algorithms.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">Specifying behaviour in these cases is beyond the scope of this document, but should be considered by Implementers and potentially in additional standards.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">EDNOTE: Max is working on a CRL mechanism to accomplish this.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="or-modes">
<section id="section-7.2">
        <h3 id="name-or-modes-2">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-or-modes-2" class="section-name selfRef">OR Modes</a>
        </h3>
<p id="section-7.2-1">TODO -- we'll need security consideration analysis of whatever OR modes we choose.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cryptographic-review-of-combiner">
<section id="section-7.3">
        <h3 id="name-cryptographic-review-of-comb">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-cryptographic-review-of-comb" class="section-name selfRef">Cryptographic review of combiner</a>
        </h3>
<p id="section-7.3-1">EDNOTE: LAMPS should probably request CFRG review of this draft to ensure that the combiner is resistant to all known cryptographic attacks.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<div id="need-for-a-kdf-within-the-combiner">
<section id="section-7.3.1">
          <h4 id="name-need-for-a-kdf-within-the-co">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-need-for-a-kdf-within-the-co" class="section-name selfRef">Need for a KDF within the combiner</a>
          </h4>
<p id="section-7.3.1-1">It is expected that the majority of uses of the KEM defined in this document will be within a construct such as <span>[<a href="#I-D.perret-prat-lamps-cms-pq-kem" class="xref">I-D.perret-prat-lamps-cms-pq-kem</a>]</span> which supplies the KEM output to a KDF in order to derive a wrapping key. In these cases it is redundant for the combiner within the composite KEM to also use a KDF. However, it is possible for protocol designers to want to use a KEM output -- or a truncation of it -- directly as a symmetric key; for this purpose we have included a KDF in the composite KEM construction.<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<p id="section-7.3.1-2">In protocols where the KEM output will be supplied to a KDF, it should be safe to use a NULL KDF within the composite KEM -- ie the KDF where <code>KDF(m) = m</code> -- but we leave the details of any such security analysis to the protocol designers who wish to implement it.<a href="#section-7.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-apop-attack">
<section id="section-7.3.2">
          <h4 id="name-apop-attack-on-concatenated-">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-apop-attack-on-concatenated-" class="section-name selfRef">APOP Attack on concatenated keys</a>
          </h4>
<p id="section-7.3.2-1">See the attack analysis described in summary in <span>[<a href="#Aviram2021" class="xref">Aviram2021</a>]</span>.<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
<p id="section-7.3.2-2">The pre-conditions for the described attack are quite strong: namely that the attacker has full control of both the content and length of the first shared secret in the combiner, and that the attacker can perform collision attacks against the underlying KDF.<a href="#section-7.3.2-2" class="pilcrow">¶</a></p>
<p id="section-7.3.2-3">We believe that, in general, neither of these pre-conditions are met within PKIX protocols. First, any key transport, key agreement, or KEM primitive approved for use within PKIX sets a fixed length for the shared secret that it produces so that the attacker cannot change the shared secret length between subsequent runs of the same protocol. This justification aligns with the justification used for <span>[<a href="#I-D.ietf-tls-hybrid-design" class="xref">I-D.ietf-tls-hybrid-design</a>]</span>. Second, any non-deprecated KDF will not allow collision attacks.<a href="#section-7.3.2-3" class="pilcrow">¶</a></p>
<p id="section-7.3.2-4">In addition, the combiner construction defined in this document aims to provide additional collision resistance on top of that provided by the underlying KDF.<a href="#section-7.3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="aviram2022">
<section id="section-7.3.3">
          <h4 id="name-aviram2022-2">
<a href="#section-7.3.3" class="section-number selfRef">7.3.3. </a><a href="#name-aviram2022-2" class="section-name selfRef">Aviram2022</a>
          </h4>
<p id="section-7.3.3-1">See the attack analysis described in summary in <span>[<a href="#Aviram2022" class="xref">Aviram2022</a>]</span>.<a href="#section-7.3.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3.3-2">This paper is largely critiquing the use of HKDF (HMAC) as a dual-PRF combiner for two secrets. This is not exactly what we are doing here.<a href="#section-7.3.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3.3-3"><span>[<a href="#Aviram2022" class="xref">Aviram2022</a>]</span> gives the following definition:
"If we would like to combine two keys, either of which might be influenced by an attacker, we need a dual-PRF as the keycombiner: That is, a function which is a PRF when keyed by either input.<a href="#section-7.3.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3.3-4">We believe the construction offered in this document meets this definition of a dual-PRF so long as the chosen KDF is itself a PRF. This holds even if the chosen KDF is HKDF with the same key (salt) used in each KDF() operation.<a href="#section-7.3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-references-2">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references-2" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references-2">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references-2" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="BSI-ECC">[BSI-ECC]</dt>
        <dd>
<span class="refAuthor">Federal Office for Information Security (BSI)</span>, <span class="refTitle">"Technical Guideline BSI TR-03111: Elliptic Curve Cryptography. Version 2.10"</span>, <time datetime="2018-06-01" class="refDate">1 June 2018</time>. </dd>
<dd class="break"></dd>
<dt id="I-D.ounsworth-pq-composite-keys">[I-D.ounsworth-pq-composite-keys]</dt>
        <dd>
<span class="refAuthor">Ounsworth, M.</span> and <span class="refAuthor">M. Pala</span>, <span class="refTitle">"Composite Public and Private Keys For Use In Internet PKI"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ounsworth-pq-composite-keys-01</span>, <time datetime="2022-02-14" class="refDate">14 February 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ounsworth-pq-composite-keys-01.txt">https://www.ietf.org/archive/id/draft-ounsworth-pq-composite-keys-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.perret-prat-lamps-cms-pq-kem">[I-D.perret-prat-lamps-cms-pq-kem]</dt>
        <dd>
<span class="refAuthor">Perret, L.</span>, <span class="refAuthor">Prat, J.</span>, and <span class="refAuthor">M. Ounsworth</span>, <span class="refTitle">"Use of Post-Quantum KEM in the Cryptographic Message Syntax (CMS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-perret-prat-lamps-cms-pq-kem-00</span>, <time datetime="2021-11-22" class="refDate">22 November 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-perret-prat-lamps-cms-pq-kem-00.txt">https://www.ietf.org/archive/id/draft-perret-prat-lamps-cms-pq-kem-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5480">[RFC5480]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refAuthor">Brown, D.</span>, <span class="refAuthor">Yiu, K.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">T. Polk</span>, <span class="refTitle">"Elliptic Curve Cryptography Subject Public Key Information"</span>, <span class="seriesInfo">RFC 5480</span>, <span class="seriesInfo">DOI 10.17487/RFC5480</span>, <time datetime="2009-03" class="refDate">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5480">https://www.rfc-editor.org/info/rfc5480</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5652">[RFC5652]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5652">https://www.rfc-editor.org/info/rfc5652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8410">[RFC8410]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure"</span>, <span class="seriesInfo">RFC 8410</span>, <span class="seriesInfo">DOI 10.17487/RFC8410</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8410">https://www.rfc-editor.org/info/rfc8410</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8411">[RFC8411]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">R. Andrews</span>, <span class="refTitle">"IANA Registration for the Cryptographic Algorithm Object Identifier Range"</span>, <span class="seriesInfo">RFC 8411</span>, <span class="seriesInfo">DOI 10.17487/RFC8411</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8411">https://www.rfc-editor.org/info/rfc8411</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHA3">[SHA3]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology (NIST)</span>, <span class="refTitle">"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions, FIPS PUB 202, DOI 10.6028/NIST.FIPS.202"</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP.800-56Ar3">[SP.800-56Ar3]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology (NIST)</span>, <span class="refTitle">"Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography"</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.690">[X.690]</dt>
      <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - ASN.1 encoding Rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ISO/IEC 8825-1:2015</span>, <time datetime="2015-11" class="refDate">November 2015</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references-2">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references-2" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Aviram2021">[Aviram2021]</dt>
        <dd>
<span class="refTitle">"Concatenating Secrets May Be Dangerous"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://github.com/nimia/kdf_public">https://github.com/nimia/kdf_public</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Aviram2022">[Aviram2022]</dt>
        <dd>
<span class="refTitle">"Practical (Post-Quantum) Key Combiners from One-Wayness and Applications to TLS."</span>, <span>n.d.</span>, <span>&lt;<a href="https://eprint.iacr.org/2022/065">https://eprint.iacr.org/2022/065</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.driscoll-pqt-hybrid-terminology">[I-D.driscoll-pqt-hybrid-terminology]</dt>
        <dd>
<span class="refAuthor">D, F.</span>, <span class="refTitle">"Terminology for Post-Quantum Traditional Hybrid Schemes"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-driscoll-pqt-hybrid-terminology-01</span>, <time datetime="2022-10-20" class="refDate">20 October 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-driscoll-pqt-hybrid-terminology-01.txt">https://www.ietf.org/archive/id/draft-driscoll-pqt-hybrid-terminology-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-hybrid-design">[I-D.ietf-tls-hybrid-design]</dt>
        <dd>
<span class="refAuthor">Stebila, D.</span>, <span class="refAuthor">Fluhrer, S.</span>, and <span class="refAuthor">S. Gueron</span>, <span class="refTitle">"Hybrid key exchange in TLS 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-hybrid-design-04</span>, <time datetime="2022-01-11" class="refDate">11 January 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-tls-hybrid-design-04.txt">https://www.ietf.org/archive/id/draft-ietf-tls-hybrid-design-04.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ounsworth-cfrg-kem-combiners">[I-D.ounsworth-cfrg-kem-combiners]</dt>
        <dd>
<span class="refAuthor">Ounsworth, M.</span>, <span class="refTitle">"Combiner function for hybrid key encapsulation mechanisms (Hybrid KEMs)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ounsworth-cfrg-kem-combiners-00</span>, <time datetime="2022-11-25" class="refDate">25 November 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ounsworth-cfrg-kem-combiners-00.txt">https://www.ietf.org/archive/id/draft-ounsworth-cfrg-kem-combiners-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ounsworth-pq-composite-sigs">[I-D.ounsworth-pq-composite-sigs]</dt>
        <dd>
<span class="refAuthor">Ounsworth, M.</span> and <span class="refAuthor">M. Pala</span>, <span class="refTitle">"Composite Signatures For Use In Internet PKI"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ounsworth-pq-composite-sigs-07</span>, <time datetime="2022-06-08" class="refDate">8 June 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ounsworth-pq-composite-sigs-07.txt">https://www.ietf.org/archive/id/draft-ounsworth-pq-composite-sigs-07.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5639">[RFC5639]</dt>
        <dd>
<span class="refAuthor">Lochter, M.</span> and <span class="refAuthor">J. Merkle</span>, <span class="refTitle">"Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and Curve Generation"</span>, <span class="seriesInfo">RFC 5639</span>, <span class="seriesInfo">DOI 10.17487/RFC5639</span>, <time datetime="2010-03" class="refDate">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5639">https://www.rfc-editor.org/info/rfc5639</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5990">[RFC5990]</dt>
        <dd>
<span class="refAuthor">Randall, J.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Brainard, J.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Use of the RSA-KEM Key Transport Algorithm in the Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">RFC 5990</span>, <span class="seriesInfo">DOI 10.17487/RFC5990</span>, <time datetime="2010-09" class="refDate">September 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5990">https://www.rfc-editor.org/info/rfc5990</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6090">[RFC6090]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Igoe, K.</span>, and <span class="refAuthor">M. Salter</span>, <span class="refTitle">"Fundamental Elliptic Curve Cryptography Algorithms"</span>, <span class="seriesInfo">RFC 6090</span>, <span class="seriesInfo">DOI 10.17487/RFC6090</span>, <time datetime="2011-02" class="refDate">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6090">https://www.rfc-editor.org/info/rfc6090</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7296">[RFC7296]</dt>
        <dd>
<span class="refAuthor">Kaufman, C.</span>, <span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time datetime="2014-10" class="refDate">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8551">[RFC8551]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refAuthor">Ramsdell, B.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 4.0 Message Specification"</span>, <span class="seriesInfo">RFC 8551</span>, <span class="seriesInfo">DOI 10.17487/RFC8551</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8551">https://www.rfc-editor.org/info/rfc8551</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="appdx-examples">
<section id="appendix-A">
      <h2 id="name-examples-2">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-examples-2" class="section-name selfRef">Examples</a>
      </h2>
<p id="appendix-A-1">TBD<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="asn1-module">
<section id="appendix-B">
      <h2 id="name-asn1-module-2">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-asn1-module-2" class="section-name selfRef">ASN.1 Module</a>
      </h2>
<p id="appendix-B-1">TBD -- UPDATE<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="appendix-B-2">
<pre class="lang-ASN.1 sourcecode">
&lt;CODE STARTS&gt;

Composite-Keys-2022
  { TBD }

DEFINITIONS IMPLICIT TAGS ::= BEGIN

EXPORTS ALL;

IMPORTS
-- any?

--
-- Object Identifiers
--

-- To be replaced by IANA
id-alg-composite-kem OBJECT IDENTIFIER ::= {
joint-iso-itu-t(2) country(16) us(840) organization(1)
entrust(114027) Algorithm(80) Composite(4) KEM (5) }

id-composite-kdf-combiner OBJECT IDENTIFIER ::= { TBD }


--
-- Composite structures
--

CompositeCiphertextValue ::= SEQUENCE SIZE (2..MAX) OF BIT STRING

kema-CompositeKEM KEM-ALGORITHM ::= {
    IDENTIFIER id-alg-composite-kem
    VALUE CompositeCiphertextValue
    PARAMS composite-kem-params
    PUBLIC-KEYS { pk-Composite }
    SMIME-CAPS { IDENTIFIED BY id-alg-composite } }
}

TODO: this assumes that KEM-ALGORITHM is defined, which it currently is not.

composite-kem-params  ::= {
    combiner     AlgorithmIdentifier
}

alg-composite-kdf-combiner-params ::= {
        kdf     AlgorithmIdentifier
}

END

&lt;CODE ENDS&gt;

</pre><a href="#appendix-B-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="intellectual-property-considerations">
<section id="appendix-C">
      <h2 id="name-intellectual-property-consid">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-intellectual-property-consid" class="section-name selfRef">Intellectual Property Considerations</a>
      </h2>
<p id="appendix-C-1">The following IPR Disclosure relates to this draft:<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">https://datatracker.ietf.org/ipr/3588/<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">EDNOTE:   I don't think this applies to this draft.<a href="#appendix-C-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors-and-acknowledgements">
<section id="appendix-D">
      <h2 id="name-contributors-and-acknowledge">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-contributors-and-acknowledge" class="section-name selfRef">Contributors and Acknowledgements</a>
      </h2>
<p id="appendix-D-1">This document incorporates contributions and comments from a large group of experts. The Editors would especially like to acknowledge the expertise and tireless dedication of the following people, who attended many long meetings and generated millions of bytes of electronic mail and VOIP traffic over the past year in pursuit of this document:<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">Serge Mister (Entrust), Ali Noman (Entrust), Scott Fluhrer (Cisco), Jan Klaussner (D-Trust), Max Pala (CableLabs), and
Douglas Stebila (University of Waterloo).<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<p id="appendix-D-3">We are grateful to all, including any contributors who may have
been inadvertently omitted from this list.<a href="#appendix-D-3" class="pilcrow">¶</a></p>
<p id="appendix-D-4">This document borrows text from similar documents, including those referenced below. Thanks go to the authors of those
   documents.  "Copying always makes things easier and less error prone" - <span>[<a href="#RFC8411" class="xref">RFC8411</a>]</span>.<a href="#appendix-D-4" class="pilcrow">¶</a></p>
<div id="making-contributions">
<section id="appendix-D.1">
        <h3 id="name-making-contributions-2">
<a href="#appendix-D.1" class="section-number selfRef">D.1. </a><a href="#name-making-contributions-2" class="section-name selfRef">Making contributions</a>
        </h3>
<p id="appendix-D.1-1">Additional contributions to this draft are welcome. Please see the working copy of this draft at, as well as open issues at:<a href="#appendix-D.1-1" class="pilcrow">¶</a></p>
<p id="appendix-D.1-2">https://github.com/EntrustCorporation/draft-composite-kem/<a href="#appendix-D.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses-2">
<a href="#name-authors-addresses-2" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mike Ounsworth</span></div>
<div dir="auto" class="left"><span class="org">Entrust Limited</span></div>
<div dir="auto" class="left"><span class="street-address">2500 Solandt Road -- Suite 100</span></div>
<div dir="auto" class="left">
<span class="locality">Ottawa, Ontario</span>  <span class="postal-code">K2K 3G5</span>
</div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mike.ounsworth@entrust.com" class="email">mike.ounsworth@entrust.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Gray</span></div>
<div dir="auto" class="left"><span class="org">Entrust Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:john.gray@entrust.com" class="email">john.gray@entrust.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
